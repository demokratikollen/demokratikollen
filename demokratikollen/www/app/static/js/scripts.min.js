demokratikollen={},demokratikollen.utils={};var utils=demokratikollen.utils;utils.parties=d3.map([{key:"v",color:"#af0000"},{key:"fi",color:"#d9308e"},{key:"pp",color:"#572b85"},{key:"s",color:"#ee2020"},{key:"mp",color:"#83cf39"},{key:"sd",color:"#dddd00"},{key:"nyd",color:"#dddd00"},{key:"-",color:"#bbbbbb"},{key:"c",color:"#009933"},{key:"m",color:"#1b49dd"},{key:"fp",color:"#6bb7ec"},{key:"kd",color:"#231977"}],function(t){return t.key}),utils.colors=d3.map([{key:"green",color:"#4cd42f"},{key:"yellow",color:"#ebeb2b"},{key:"red",color:"#cb1310"}],function(t){return t.key}),utils.parties.forEach(function(t,e){utils.colors.set(t,{key:e.key,color:e.color})}),parties={mapChart:function(t){function e(t){return function(e){return e[t]}}function a(a){a.each(function(a){var c=a.max_municipality,u=d3.select(this).selectAll("svg").data([a.municipalities]);l.scale(10*n).translate([n/2,r/2]),i.projection(l);var p="rotate(10,"+n/2+","+r/2+")",d=u.enter().append("svg").append("g"),m=(d.attr("class","map-collection").attr("transform",p).selectAll(".map-region").data(t.features,e("id")).enter().append("path").attr("class","map-region").attr("d",i),u.attr("width",n).attr("height",r).selectAll(".map-region").data(a.municipalities,e("id"))),f=d3.rgb("#eee"),g=d3.rgb(o),h=d3.scale.linear().domain([0,c]).range([f,g]),y=d3.select("body").append("div").attr("class","election-tooltip").style("opacity",0),k=y.append("div"),v=y.append("figure").style("display","block").style("padding-top","5px");m.on("mouseover",function(t){pColor=h(.5*c),k.html("<strong>"+s.get(t.id).properties.name+":</strong> <span style='color:"+pColor+"'>"+d3.format(".1f")(100*t.votes)+"</span> % "+parties.year),d3.json("/data/elections/timeseries/"+parties.party+"/"+t.id+".json",function(t,e){timeSeriesChart=parties.timeSeriesChart().lineColor(pColor),v.datum(e.d).call(timeSeriesChart)}),y.transition().duration(100).style("opacity",.8)}).on("mousemove",function(){y.style("top",event.pageY-110+"px").style("left",event.pageX+3+"px")}).on("mouseout",function(){y.transition().duration(100).style("opacity",0)}),m.attr("fill",f).transition().duration(200).attr("fill",function(t){return h(t.votes)}),m.exit().transition().duration(200).attr("fill","black")})}var n=130,r=2.53846153846*n,o="steelblue",l=d3.geo.conicEqualArea().parallels([50,70]).center([16.6358,62.1792]),i=d3.geo.path(),s=d3.map(t.features,e("id"));return a.projection=function(t){return arguments.length?(l=t,a):l},a.width=function(t){return arguments.length?(n=t,r=2.53846153846*t,a):n},a.height=function(t){return arguments.length?(r=t,n=t/2.53846153846,a):r},a.color=function(t){return arguments.length?(o=t,a):o},a},timeSeriesChart:function(){function t(t){t.each(function(t){t.forEach(function(t){t.year=parseInt(t.year),t.votes=+t.votes}),console.log(t);var c=d3.select(this).selectAll("svg").data([t]);c.enter().append("svg").attr("width",a+e.left+e.right).attr("height",n+e.top+e.bottom),c=c.selectAll("g").data([t]);var u=d3.extent(t,function(t){return t.year});r.domain(u),u.splice(1,0,d3.median(t,function(t){return t.year})),i.tickValues(u);var p=d3.extent(t,function(t){return t.votes});s.tickValues(p),o.domain(p);var d=c.enter().append("g").attr("transform","translate("+e.left+","+e.top+")");d.append("path").attr("class","line").style("fill","none").style("stroke",lineColor).style("stroke-width","1.5px"),d.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")"),d.append("g").attr("class","y axis").append("text").attr("class","label"),c.selectAll("g.y.axis").call(s).selectAll("text.label").attr("x",1).attr("dx",".71em").style("text-anchor","start").style("alignment-baseline","middle").text("%"),c.selectAll("g.x.axis").call(i),c.selectAll("path.line").data([t]).attr("d",l)})}var e={top:7,right:12,bottom:17,left:25},a=170-e.left-e.right,n=60-e.top-e.bottom;lineColor="steelblue";var r=d3.scale.linear().range([0,a]),o=d3.scale.linear().range([n,0]),l=d3.svg.line().x(function(t){return r(t.year)}).y(function(t){return o(t.votes)}),i=d3.svg.axis().scale(r).tickFormat(d3.format(".0f")).orient("bottom"),s=d3.svg.axis().scale(o).tickFormat(function(t){return t>=.1?d3.format(".0f")(100*t):d3.format(".1f")(100*t).replace(".",",")}).orient("left");return t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(n=e,t):n},t.lineColor=function(e){return arguments.length?(lineColor=e,t):lineColor},t},setup:function(t,e,a,n){parties.party=a,parties.year=n,d3.json("/data/municipalities.topojson",function(n,r){var o=topojson.feature(r,r.objects.municipalities),l=parties.mapChart(o).width(150).color(utils.parties.get(a).color),i=d3.select(t);parties.updateMap=function(t){i.datum(t).call(l)},parties.updateMap(e)})}},Search={Setup:function(){$("#main-search input").on("focusin",function(){$("#main-search").addClass("open")}),$("#main-search input").on("focusout",function(){$("#main-search").removeClass("open")});var t,e={minChars:2};$.getJSON("/data/parliament/members_search.json",function(e){t=new Fuse(e.d,{keys:["fullName","party","groups"],threshold:.6})}),$("#main-search input").on("input",function(t){t.target.value.length>=e.minChars&&(console.log(t),$("#main-search .dropdown-menu").addClass("open"),$("#test").html(t.target.value))})}};
//# sourceMappingURL=../js/scripts.min.js.map