demokratikollen={},demokratikollen.utils={},demokratikollen.graphics={};var utils=demokratikollen.utils;utils.parties=d3.map([{key:"v",color:"#af0000"},{key:"fi",color:"#d9308e"},{key:"pp",color:"#572b85"},{key:"s",color:"#ee2020"},{key:"mp",color:"#83cf39"},{key:"sd",color:"#dddd00"},{key:"nyd",color:"#dddd00"},{key:"-",color:"#bbbbbb"},{key:"c",color:"#009933"},{key:"m",color:"#1b49dd"},{key:"fp",color:"#6bb7ec"},{key:"kd",color:"#231977"}],function(t){return t.key}),utils.colors=d3.map([{key:"green",color:"#4cd42f"},{key:"yellow",color:"#ebeb2b"},{key:"red",color:"#cb1310"}],function(t){return t.key}),utils.parties.forEach(function(t,e){utils.colors.set(t,{key:e.key,color:e.color})}),demokratikollen.graphics.AppointmentsTimeline=function(){function t(t){return d3.min(t,function(t){return t.startDate})}function e(t){return d3.max(t,function(t){return t.endDate})}function n(n,r){return maxDates=[e(n.values),e(r.values)],maxDates[0]!=maxDates[1]?maxDates[1]-maxDates[0]:t(r.values)-t(n.values)}function r(t){return t.reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[])}function a(a){a.each(function(a){dataByRowLabel=d3.nest().key(function(t){return t.rowLabel}).entries(a),dataByRowLabel.sort(n);var g=dataByRowLabel.map(function(t){return t.key}),m=t(a),f=e(a);d3.select(this).classed("chart",!0);var h=this.getBoundingClientRect().width-l.left-l.right,y=g.length*o,v=d3.select(this).append("svg").attr("width",h+l.left+l.right).attr("height",y+l.top+l.bottom).append("g").attr("transform","translate("+l.left+","+l.top+")");v.append("rect").attr("width",h).attr("height",y).classed("background",!0);var b=d3.time.scale().domain([m,f]).range([0,h]).nice(c),k=d3.scale.ordinal().domain(g).rangePoints([0,y],1),x=b.ticks(Math.floor(h/u));x=r(x.map(c.floor));var w=d3.svg.axis().scale(b).orient("top").tickSize(-y,0).tickValues(x);w=v.append("g").classed("axis x",!0).call(w),w.selectAll("text").style("text-anchor","start"),v.append("g").classed("rowLabels",!0).selectAll("rowLabels").data(g).enter().append("text").text(function(t){return t}).attr("transform",function(t){return"translate("+s+","+k(t)+")"});var C=d3.svg.line().x(function(t){return b(t[0])}).y(function(t){return k(t[1])});linesSelection=v.append("g").attr("transform",function(){return"translate(0,"+i+")"}).classed("lines",!0).selectAll("lines").data(a).enter(),lines=linesSelection.append("path").attr("d",function(t){return C([[t.startDate,t.rowLabel],[t.endDate,t.rowLabel]])}).attr("class",function(t){return t.cssClass||""}),linesSelection.append("circle").attr("cx",function(t){return b(t.startDate)}).attr("cy",function(t){return k(t.rowLabel)}).attr("r",p),linesSelection.append("circle").attr("cx",function(t){return b(t.endDate)}).attr("cy",function(t){return k(t.rowLabel)}).attr("r",p),d&&(tip=d3.tip().attr("class","d3-tip time-schedule").direction(function(t){var e=b(t.startDate),n=b(t.endDate),r=h/2;return r>=e&&n>=r?"s":e>=r?"sw":r>=n?"se":void 0}).offset(function(t){var e=b(t.startDate),n=b(t.endDate),r=(e+n)/2,a=h/2;return a>=e&&n>=a?[10,a-r]:e>=a?[10,-10]:a>=n?[10,10]:void 0}).html(d),linesSelection.append("path").style("stroke","rgba(0,0,0,0)").style("stroke-width",o-5).attr("d",function(t){return C([[t.startDate,t.rowLabel],[t.endDate,t.rowLabel]])}).call(tip).on("mouseover",tip.show).on("mouseout",tip.hide))})}var o=40,i=10,l={top:40,right:0,bottom:10,left:0},s=10,c=d3.time.year,u=100,d=null,p=4;return a.tipHtml=function(t){return arguments.length?(d=t,a):d},a.timeUnit=function(t){return arguments.length?(c=t,a):c},a.tickLabelWidth=function(t){return arguments.length?(u=t,a):u},a},demokratikollen.graphics.mapChart=function(t){function e(t){return function(e){return e[t]}}function n(n){n.each(function(n){function s(){console.log("zoomg"),h.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}var g=d3.select(this).selectAll("svg").data([n]);u.scale(10*i).translate([i/2,l/2]),d.projection(u);var f="rotate(10,"+i/2+","+l/2+")",h=g.enter().append("svg").append("g"),y=d3.behavior.zoom().scaleExtent([1,8]).on("zoom",s);g.call(y).call(y.event);h.attr("class","map-collection").attr("transform",f).selectAll(".map-region").data(t.features,e("id")).enter().append("path").attr("class","map-region").attr("d",d);h.selectAll(".map-region-border").data([r]).enter().append("path").attr("class","map-region-border").attr("d",d);var v=g.attr("width",i).attr("height",l).selectAll(".map-region").data(n,e("id")),b=m.domain(),k=b.reduce(function(t,e){return t+e})/b.length,x=m(k);if(a){var w,C=40,A=d3.select("body").append("div").attr("class","election-tooltip").style("opacity",0),D=A.append("div");if(o){void 0!=c.margin&&(C+=c.margin().top+c.margin().bottom),C+=c.height();var S=A.append("figure").style("display","block");C+=7}v.on("mouseover",function(t){D.html(a(t)).select("span.votes").style("color",x),o&&d3.json(o(t),function(t,e){S.datum(e.d).call(c),w=A.node().getBoundingClientRect().height}),A.transition().duration(100).style("opacity",.8)}).on("mousemove",function(){void 0==w&&(w=C),A.style("top",event.pageY-w+"px").style("left",event.pageX+"px")}).on("mouseout",function(){A.transition().duration(100).style("opacity",0)})}v.attr("fill",p).transition().duration(200).attr("fill",function(t){return m(t.votes)}),v.exit().transition().duration(200).attr("fill","black")})}var r;arguments.length>1&&(r=arguments[1]);var a,o,i=130,l=2.53846153846*i,s="steelblue",c=demokratikollen.graphics.timeSeriesChart(),u=d3.geo.conicEqualArea().parallels([50,70]).center([16.6358,62.1792]),d=d3.geo.path(),p=d3.rgb("#eee"),g=d3.rgb(s),m=d3.scale.linear().domain([0,1]).range([p,g]);return n.projection=function(t){return arguments.length?(u=t,n):u},n.tooltipTextHtml=function(t){return arguments.length?(a=t,n):a},n.tooltipFigureDataUrl=function(t){return arguments.length?(o=t,n):o},n.tooltipChart=function(t){return arguments.length?(c=t,n):c},n.width=function(t){return arguments.length?(i=t,l=2.53846153846*t,n):i},n.height=function(t){return arguments.length?(l=t,i=t/2.53846153846,n):l},n.colorScale=function(t){return arguments.length?(m=t,n):m},n},demokratikollen.graphics.timeSeriesChart=function(){function t(t){t.each(function(t){var o=d3.select(this).selectAll("svg").data([t]);o.enter().append("svg").attr("width",n+e.left+e.right).attr("height",r+e.top+e.bottom),o=o.selectAll("g").data([t]);var i=o.enter().append("g").attr("transform","translate("+e.left+","+e.top+")");i.append("path").attr("class","line").style("fill","none").style("stroke",a).style("stroke-width","1.5px"),i.append("g").attr("class","x axis"),i.append("g").attr("class","y axis").append("text").attr("class","label"),o.selectAll("g.y.axis").call(c).selectAll("text.label").attr("x",1).attr("dx",".71em").style("text-anchor","start").style("alignment-baseline","middle").text("%"),o.selectAll("g.x.axis").attr("transform","translate(0,"+r+")").call(s),o.selectAll("path.line").data([t]).attr("d",l)})}var e={top:7,right:12,bottom:17,left:25},n=170-e.left-e.right,r=60-e.top-e.bottom,a="steelblue",o=d3.scale.linear().range([0,n]),i=d3.scale.linear().range([r,0]),l=d3.svg.line().x(function(t){return o(t.x)}).y(function(t){return i(t.y)}),s=d3.svg.axis().scale(o).orient("bottom"),c=d3.svg.axis().scale(i).orient("left");return t.width=function(e){return arguments.length?(n=e,t):n},t.height=function(e){return arguments.length?(r=e,t):r},t.margin=function(n){return arguments.length?(e=n,t):e},t.line=function(e){return arguments.length?(l=e,t):l},t.xAxis=function(e){return arguments.length?(s=e,t):s},t.yAxis=function(e){return arguments.length?(c=e,t):c},t.xScale=function(e){return arguments.length?(o=e,t):o},t.yScale=function(e){return arguments.length?(i=e,t):i},t.lineColor=function(e){return arguments.length?(a=e,t):a},t},parties={tooltipFigure:function(){function t(t){t.each(function(t){t.forEach(function(t){t.year=parseInt(t.year),t.votes=+t.votes});var e=d3.extent(t,function(t){return t.year});o.domain(e);var n=d3.extent(t,function(t){return t.votes});i.domain(n),e.splice(1,0,d3.median(t,function(t){return t.year})),l.tickValues(e),s.tickValues(n),s.tickFormat(function(t){return t>=.1?d3.format(".0f")(100*t):d3.format(".1f")(100*t).replace(".",",")}),l.tickFormat(d3.format(".0f"))}),a(t)}var e={top:12,right:12,bottom:17,left:25},n=170-e.left-e.right,r=60-e.top-e.bottom,a=demokratikollen.graphics.timeSeriesChart().lineColor(parties.pColorMild).width(n).height(r).margin(e),o=a.xScale().range([0,n]),i=a.yScale().range([r,0]),l=a.xAxis(),s=a.yAxis(),c=d3.svg.line().x(function(t){return o(t.year)}).y(function(t){return i(t.votes)});return a.line(c),t.width=function(e){return arguments.length?(n=e,t):n},t.height=function(e){return arguments.length?(r=e,t):r},t.margin=function(n){return arguments.length?(e=n,t):e},t},setup:function(t,e,n,r){parties.party=n,parties.year=r,parties.pColor=utils.parties.get(n).color,parties.pColorMild=d3.interpolateRgb(d3.rgb("#eee"),parties.pColor)(.5);var a=d3.rgb("#eee"),o=d3.rgb(parties.pColor),i=e.max_municipality,l=d3.scale.linear().domain([0,i]).range([a,o]);d3.json("/data/municipalities.topojson",function(a,o){var i=topojson.feature(o,o.objects.municipalities),s=topojson.mesh(o,o.objects.municipalities,function(t,e){return t!==e}),c=d3.map(i.features,function(t){return t.id}),u=demokratikollen.graphics.mapChart(i,s).width(150).tooltipTextHtml(function(t){return"<strong>"+c.get(t.id).properties.name+":</strong> <span class='votes'>"+d3.format(".1f")(100*t.votes)+"</span> % "+r}).tooltipFigureDataUrl(function(t){return"/data/elections/timeseries/"+n+"/"+t.id+".json"}).tooltipChart(parties.tooltipFigure()).colorScale(l),d=d3.select(t);parties.updateMap=function(t){d.datum(t.municipalities).call(u)},parties.updateMap(e)})}},Search={Setup:function(){$("#main-search input").on("focusin",function(){$("#main-search").addClass("open")}),$("#main-search input").on("focusout",function(){$("#main-search").removeClass("open")});var t,e={minChars:2};$.getJSON("/data/parliament/members_search.json",function(e){t=new Fuse(e.d,{keys:["fullName","party","groups"],threshold:.6})}),$("#main-search input").on("input",function(t){t.target.value.length>=e.minChars&&(console.log(t),$("#main-search .dropdown-menu").addClass("open"),$("#test").html(t.target.value))})}};
//# sourceMappingURL=../js/scripts.min.js.map