machine:
  python:
    version: 3.5.1
  environment:
    DATABASE_URL: "postgres://ubuntu:@127.0.0.1:5432/"
    MONGO_DATABASE_URL: "mongodb://localhost:27017/"
    PYTHONPATH: /home/ubuntu/demokratikollen

database:
  post:
    - gunzip -c demokratikollen/data/dumps/postgres_dump.sql.gz | psql -U ubuntu
    - tar -xvf demokratikollen/data/dumps/mongodb_dump.tar.gz
    - mongorestore --host localhost  mongodb_dump

dependencies:
  pre:
    - pip install -r demokratikollen/requirements/dev.txt

test:
  override:
    - pytest --junitxml=$CIRCLE_TEST_REPORTS/junit/test_results.xml demokratikollen/www/specs
